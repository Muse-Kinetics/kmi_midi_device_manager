// Copyright (c) 2025 KMI Music, Inc.
// This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
// If a copy of the MPL was not distributed with this file, You can obtain one at https://mozilla.org/MPL/2.0/.
#ifndef KMI_SYSEXMESSAGES_H
#define KMI_SYSEXMESSAGES_H

#include "midi.h"
#include "KMI_DevData.h"


// ************************************************
// SysEx Messages


// Universal Device ID and Firmware Request
unsigned char _sx_id_req_standard[] =
{
    MIDI_SX_START,
    SX_UNIVERSAL,
    SX_ADD_IGNORE,
    SX_UNV_INFO,
    SX_UNV_DEVID_REQ,
    MIDI_SX_STOP
};

// Universal Device ID and Firmware Reply (kmi is usually "sysex channel" 0)
unsigned char _sx_id_reply_standard[] =
{
    MIDI_SX_START,
    SX_UNIVERSAL,
    SX_ADD_ZERO,        // this can be anything from 0-0x7F
    SX_UNV_INFO,
    SX_UNV_DEVID_REPLY
};

unsigned char _sx_ack_loop_test[] =
{
    MIDI_SX_START,
    SX_UNIVERSAL,
    SX_ADD_IGNORE,
    SX_UNIV_ACK,
    36,                 // magic number for detecting midi feedback loops
    MIDI_SX_STOP,
};

// SoftStep Firmware Request
unsigned char _fw_req_softstep[] =
{
    0xF0,0x00,0x1B,0x48,0x7A,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x04,0x40,
    0x00,0x30,0xF7
};

//// SoftStep alternate firmware version request string
//unsigned char _fw_req_softstep[] =
//{
//    0xF0, 0x00, 0x1B, 0x48, 0x7A, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
//    0x00, 0x01, 0x00, 0x09, 0x00, 0x0B, 0x2B, 0x3A, 0x00, 0x10, 0x08, 0x01, 0x01, 0x00, 0x00, 0x00,
//    0x00, 0x00, 0x00, 0x7B, 0x69, 0x00, 0x00, 0x00, 0x00, 0x02, 0xF7
//};

// SoftStep Firmware Reply
unsigned char _fw_reply_softstep[] =
{
    0x1B, 0x48, 0x7A, 0x01
};

// 12Step Firmware Request
unsigned char _fw_req_12step[] =
{
    0xF0,0x00,0x01,0x55,0x7A,0x14,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x04,0x40,
    0x00,0x30,0xF7
};

// 12Step Firmware Reply
unsigned char _fw_reply_12step[] =
{
    0x00, 0x01, 0x55, 0x7A, 0x14
};

// ***** QuNeo Specific commands *************************
// QuNeo swap LEDs
unsigned char _quneo_swap_leds[] =
{
    0xF0, 0x00, 0x01, 0x5F, 0x7A, 0x1E, 0x00, 0x01, 0x00, 0x02, 0x50, 0x02, 0x44, 0x5D, 0x00, 0x10, 0xF7
};

// QuNeo query board ID
unsigned char _quneo_board_id_query[] =
{
    0xF0, 0x7E, 0x7F, 0x06, 0x01, 0xF7
};

// EB TODO - what are these for?
unsigned char _quneo_toggleProgramChangeInSysExData[] =
{
    0xF0, 0x00, 0x01, 0x5F, 0x7A, 0x1E, 0x00, 0x01, 0x00, 0x02, 0x50, 0x06, 0x04, 0x59, 0x00, 0x30, 0xF7
};

// EB TODO - what are these for?
unsigned char _quneo_toggleProgramChangeOutSysExData[] =
{
    0xF0, 0x00, 0x01, 0x5F, 0x7A, 0x1E, 0x00, 0x01, 0x00, 0x02, 0x50, 0x05, 0x34, 0x3A, 0x00, 0x30, 0xF7
};


// *********************************************************
// Enter bootloader commands - TODO see if this can be done programatically or in an array

// QuNexus
unsigned char _bl_qunexus[] =
{
    0xF0, 0x00, 0x01, 0x5F, 0x7A, 0x19, 0x00, 0x01, 0x00, 0x02, 0x11, 0x00, 0x5A, 0x62, 0x00, 0x30, 0xF7
};

// QuNeo
unsigned char _bl_quneo[] =
{
    0xF0, 0x00, 0x01, 0x5F, 0x7A, 0x1E, 0x00, 0x01, 0x00, 0x02, 0x11, 0x00, 0x5A, 0x62, 0x00, 0x30, 0x10, 0xF7
};


// *********************************************************


#endif // KMI_SYSEXMESSAGES_H
